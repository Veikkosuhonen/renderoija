(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))n(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&n(o)}).observe(document,{childList:!0,subtree:!0});function r(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function n(s){if(s.ep)return;s.ep=!0;const i=r(s);fetch(s.href,i)}})();const et=!1,tt=(e,t)=>e===t,G={equals:tt};let rt=We;const L=1,V=2,Re={owned:null,cleanups:null,context:null,owner:null};var m=null;let se=null,st=null,f=null,g=null,A=null,J=0;function nt(e,t){const r=f,n=m,s=e.length===0,i=t===void 0?n:t,o=s?Re:{owned:null,cleanups:null,context:i?i.context:null,owner:i},l=s?e:()=>e(()=>O(()=>D(o)));m=o,f=null;try{return M(l,!0)}finally{f=r,m=n}}function y(e,t){t=t?Object.assign({},G,t):G;const r={value:e,observers:null,observerSlots:null,comparator:t.equals||void 0},n=s=>(typeof s=="function"&&(s=s(r.value)),Ue(r,s));return[Be.bind(r),n]}function x(e,t,r){const n=De(e,t,!1,L);X(n)}function ne(e,t,r){r=r?Object.assign({},G,r):G;const n=De(e,t,!0,0);return n.observers=null,n.observerSlots=null,n.comparator=r.equals||void 0,X(n),Be.bind(n)}function O(e){if(f===null)return e();const t=f;f=null;try{return e()}finally{f=t}}function Be(){if(this.sources&&this.state)if(this.state===L)X(this);else{const e=g;g=null,M(()=>q(this),!1),g=e}if(f){const e=this.observers?this.observers.length:0;f.sources?(f.sources.push(this),f.sourceSlots.push(e)):(f.sources=[this],f.sourceSlots=[e]),this.observers?(this.observers.push(f),this.observerSlots.push(f.sources.length-1)):(this.observers=[f],this.observerSlots=[f.sources.length-1])}return this.value}function Ue(e,t,r){let n=e.value;return(!e.comparator||!e.comparator(n,t))&&(e.value=t,e.observers&&e.observers.length&&M(()=>{for(let s=0;s<e.observers.length;s+=1){const i=e.observers[s],o=se&&se.running;o&&se.disposed.has(i),(o?!i.tState:!i.state)&&(i.pure?g.push(i):A.push(i),i.observers&&je(i)),o||(i.state=L)}if(g.length>1e6)throw g=[],new Error},!1)),t}function X(e){if(!e.fn)return;D(e);const t=J;it(e,e.value,t)}function it(e,t,r){let n;const s=m,i=f;f=m=e;try{n=e.fn(t)}catch(o){return e.pure&&(e.state=L,e.owned&&e.owned.forEach(D),e.owned=null),e.updatedAt=r+1,Ie(o)}finally{f=i,m=s}(!e.updatedAt||e.updatedAt<=r)&&(e.updatedAt!=null&&"observers"in e?Ue(e,n):e.value=n,e.updatedAt=r)}function De(e,t,r,n=L,s){const i={fn:e,state:n,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:m,context:m?m.context:null,pure:r};return m===null||m!==Re&&(m.owned?m.owned.push(i):m.owned=[i]),i}function Me(e){if(e.state===0)return;if(e.state===V)return q(e);if(e.suspense&&O(e.suspense.inFallback))return e.suspense.effects.push(e);const t=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<J);)e.state&&t.push(e);for(let r=t.length-1;r>=0;r--)if(e=t[r],e.state===L)X(e);else if(e.state===V){const n=g;g=null,M(()=>q(e,t[0]),!1),g=n}}function M(e,t){if(g)return e();let r=!1;t||(g=[]),A?r=!0:A=[],J++;try{const n=e();return lt(r),n}catch(n){r||(A=null),g=null,Ie(n)}}function lt(e){if(g&&(We(g),g=null),e)return;const t=A;A=null,t.length&&M(()=>rt(t),!1)}function We(e){for(let t=0;t<e.length;t++)Me(e[t])}function q(e,t){e.state=0;for(let r=0;r<e.sources.length;r+=1){const n=e.sources[r];if(n.sources){const s=n.state;s===L?n!==t&&(!n.updatedAt||n.updatedAt<J)&&Me(n):s===V&&q(n,t)}}}function je(e){for(let t=0;t<e.observers.length;t+=1){const r=e.observers[t];r.state||(r.state=V,r.pure?g.push(r):A.push(r),r.observers&&je(r))}}function D(e){let t;if(e.sources)for(;e.sources.length;){const r=e.sources.pop(),n=e.sourceSlots.pop(),s=r.observers;if(s&&s.length){const i=s.pop(),o=r.observerSlots.pop();n<s.length&&(i.sourceSlots[o]=n,s[n]=i,r.observerSlots[n]=o)}}if(e.tOwned){for(t=e.tOwned.length-1;t>=0;t--)D(e.tOwned[t]);delete e.tOwned}if(e.owned){for(t=e.owned.length-1;t>=0;t--)D(e.owned[t]);e.owned=null}if(e.cleanups){for(t=e.cleanups.length-1;t>=0;t--)e.cleanups[t]();e.cleanups=null}e.state=0}function ot(e){return e instanceof Error?e:new Error(typeof e=="string"?e:"Unknown error",{cause:e})}function Ie(e,t=m){throw ot(e)}function N(e,t){return O(()=>e(t||{}))}const at=e=>`Stale read from <${e}>.`;function I(e){const t=e.keyed,r=ne(()=>e.when,void 0,void 0),n=t?r:ne(r,void 0,{equals:(s,i)=>!s==!i});return ne(()=>{const s=n();if(s){const i=e.children;return typeof i=="function"&&i.length>0?O(()=>i(t?s:()=>{if(!O(n))throw at("Show");return r()})):i}return e.fallback},void 0,void 0)}function ct(e,t,r){let n=r.length,s=t.length,i=n,o=0,l=0,c=t[s-1].nextSibling,u=null;for(;o<s||l<i;){if(t[o]===r[l]){o++,l++;continue}for(;t[s-1]===r[i-1];)s--,i--;if(s===o){const d=i<n?l?r[l-1].nextSibling:r[i-l]:c;for(;l<i;)e.insertBefore(r[l++],d)}else if(i===l)for(;o<s;)(!u||!u.has(t[o]))&&t[o].remove(),o++;else if(t[o]===r[i-1]&&r[l]===t[s-1]){const d=t[--s].nextSibling;e.insertBefore(r[l++],t[o++].nextSibling),e.insertBefore(r[--i],d),t[s]=r[i]}else{if(!u){u=new Map;let p=l;for(;p<i;)u.set(r[p],p++)}const d=u.get(t[o]);if(d!=null)if(l<d&&d<i){let p=o,b=1,h;for(;++p<s&&p<i&&!((h=u.get(t[p]))==null||h!==d+b);)b++;if(b>d-l){const K=t[o];for(;l<d;)e.insertBefore(r[l++],K)}else e.replaceChild(r[l++],t[o++])}else o++;else t[o++].remove()}}}const Fe="_$DX_DELEGATE";function ut(e,t,r,n={}){let s;return nt(i=>{s=i,t===document?e():v(t,e(),t.firstChild?null:void 0,r)},n.owner),()=>{s(),t.textContent=""}}function P(e,t,r,n){let s;const i=()=>{const l=document.createElement("template");return l.innerHTML=e,l.content.firstChild},o=()=>(s||(s=i())).cloneNode(!0);return o.cloneNode=o,o}function ft(e,t=window.document){const r=t[Fe]||(t[Fe]=new Set);for(let n=0,s=e.length;n<s;n++){const i=e[n];r.has(i)||(r.add(i),t.addEventListener(i,pt))}}function ke(e,t,r){r==null?e.removeAttribute(t):e.setAttribute(t,r)}function dt(e,t,r){return O(()=>e(t,r))}function v(e,t,r,n){if(r!==void 0&&!n&&(n=[]),typeof t!="function")return H(e,t,n,r);x(s=>H(e,t(),s,r),n)}function pt(e){let t=e.target;const r=`$$${e.type}`,n=e.target,s=e.currentTarget,i=c=>Object.defineProperty(e,"target",{configurable:!0,value:c}),o=()=>{const c=t[r];if(c&&!t.disabled){const u=t[`${r}Data`];if(u!==void 0?c.call(t,u,e):c.call(t,e),e.cancelBubble)return}return t.host&&typeof t.host!="string"&&!t.host._$host&&t.contains(e.target)&&i(t.host),!0},l=()=>{for(;o()&&(t=t._$host||t.parentNode||t.host););};if(Object.defineProperty(e,"currentTarget",{configurable:!0,get(){return t||document}}),e.composedPath){const c=e.composedPath();i(c[0]);for(let u=0;u<c.length-2&&(t=c[u],!!o());u++){if(t._$host){t=t._$host,l();break}if(t.parentNode===s)break}}else l();i(n)}function H(e,t,r,n,s){for(;typeof r=="function";)r=r();if(t===r)return r;const i=typeof t,o=n!==void 0;if(e=o&&r[0]&&r[0].parentNode||e,i==="string"||i==="number"){if(i==="number"&&(t=t.toString(),t===r))return r;if(o){let l=r[0];l&&l.nodeType===3?l.data!==t&&(l.data=t):l=document.createTextNode(t),r=k(e,r,n,l)}else r!==""&&typeof r=="string"?r=e.firstChild.data=t:r=e.textContent=t}else if(t==null||i==="boolean")r=k(e,r,n);else{if(i==="function")return x(()=>{let l=t();for(;typeof l=="function";)l=l();r=H(e,l,r,n)}),()=>r;if(Array.isArray(t)){const l=[],c=r&&Array.isArray(r);if(ie(l,t,r,s))return x(()=>r=H(e,l,r,n,!0)),()=>r;if(l.length===0){if(r=k(e,r,n),o)return r}else c?r.length===0?Ne(e,l,n):ct(e,r,l):(r&&k(e),Ne(e,l));r=l}else if(t.nodeType){if(Array.isArray(r)){if(o)return r=k(e,r,n,t);k(e,r,null,t)}else r==null||r===""||!e.firstChild?e.appendChild(t):e.replaceChild(t,e.firstChild);r=t}}return r}function ie(e,t,r,n){let s=!1;for(let i=0,o=t.length;i<o;i++){let l=t[i],c=r&&r[e.length],u;if(!(l==null||l===!0||l===!1))if((u=typeof l)=="object"&&l.nodeType)e.push(l);else if(Array.isArray(l))s=ie(e,l,c)||s;else if(u==="function")if(n){for(;typeof l=="function";)l=l();s=ie(e,Array.isArray(l)?l:[l],Array.isArray(c)?c:[c])||s}else e.push(l),s=!0;else{const d=String(l);c&&c.nodeType===3&&c.data===d?e.push(c):e.push(document.createTextNode(d))}}return s}function Ne(e,t,r=null){for(let n=0,s=t.length;n<s;n++)e.insertBefore(t[n],r)}function k(e,t,r,n){if(r===void 0)return e.textContent="";const s=n||document.createTextNode("");if(t.length){let i=!1;for(let o=t.length-1;o>=0;o--){const l=t[o];if(s!==l){const c=l.parentNode===e;!i&&!o?c?e.replaceChild(s,l):e.insertBefore(s,r):c&&l.remove()}else i=!0}}else e.insertBefore(s,r);return[s]}const ht=async(e,t,r)=>{const n=new Worker(new URL(""+new URL("rendererWorker-DXMqt8xX.js",import.meta.url).href,import.meta.url)),s=new Worker(new URL(""+new URL("encoderWorker-CRxPo6p9.js",import.meta.url).href,import.meta.url),{type:"module"}),i={messageType:"submit",job:e};n.postMessage(i);const o=new Promise((d,p)=>{n.onmessage=b=>{const h=b.data;switch(h.messageType){case"frame":s.postMessage(h),t(h);break;case"completed":d(h),n.terminate();break;case"error":p(h.error),n.terminate();break}},n.onerror=b=>{p(b),n.terminate(),s.terminate()}});s.postMessage(i);const l=new Promise((d,p)=>{s.onmessage=b=>{const h=b.data;switch(h.messageType){case"frame":break;case"completed":d(h),s.terminate();break;case"error":p(h.error),s.terminate();break}},s.onerror=b=>{p(b),n.terminate(),s.terminate()}}),[c,u]=await Promise.all([o,l]);return u};var gt=P("<div class=cs-progress-bar><div class=bars>"),mt=P("<p>Rendering frame <!> of "),bt=P("<p>Avg FPS: "),yt=P("<p>Render completed in <!> seconds!"),vt=P("<p>Render failed!"),wt=P('<form><div><section><textarea class=cs-input placeholder="Paste GLSL"></textarea></section><section><div><input type=number class=cs-input id=width><label class=cs-input__label for=width>Width (px)</label></div><div><input type=number class=cs-input id=height><label class=cs-input__label for=height>Height (px)</label></div><div><input type=number class=cs-input id=duration><label class=cs-input__label for=duration>Duration (seconds)</label></div><div><input type=number class=cs-input id=fps><label class=cs-input__label for=fps>FPS</label></div><div><p>Frames: </p><p>Frame time: <!>s</p></div><div><input type=number class=cs-input id=bitrate><label class=cs-input__label for=bitrate>Bitrate</label></div><div><p>Estimated file size: <!> KB</p></div><button class=cs-btn>Begin render</button><p></p></section><section><div><p>Preview</p><button class=cs-btn type=button></button></div><canvas class=cs-canvas id=output>');const $t=()=>{let e;const[t,r]=y(!0),[n,s]=y(St),[i,o]=y(1080),[l,c]=y(1920),[u,d]=y(20),[p,b]=y(30),[h,K]=y(6e6),[Ge,Et]=y("vp09.00.10.08"),[le,Ve]=y(0),Q=()=>u()*p(),oe=()=>1/p(),qe=()=>le()/(u()*p())*100,[_,Y]=y("idle"),[He,ae]=y(""),[ce,ue]=y(0),[Je,Xe]=y(1),Ke=async R=>{R.preventDefault(),ae(""),ue(0);const T=e.getContext("bitmaprenderer"),B=Date.now(),E=w=>{Ve(w.frame),Xe((Date.now()-B)/(w.frame+1)),t()&&T.transferFromImageBitmap(w.image)},S=w=>{};Y("working");try{const w=await ht({glsl:n(),width:i(),height:l(),numFrames:Q(),frameTime:oe(),framerate:p(),bitrate:h(),codec:Ge()},E,S);xt(w.buffer),Y("idle"),ue(Date.now()-B)}catch(w){const F=w;console.error(F),ae(F.toString()),Y("error")}};return(()=>{var R=wt(),T=R.firstChild,B=T.firstChild,E=B.firstChild,S=B.nextSibling,w=S.firstChild,F=w.firstChild,fe=w.nextSibling,Z=fe.firstChild,de=fe.nextSibling,z=de.firstChild,pe=de.nextSibling,ee=pe.firstChild,he=pe.nextSibling,te=he.firstChild;te.firstChild;var ge=te.nextSibling,Qe=ge.firstChild,me=Qe.nextSibling;me.nextSibling;var be=he.nextSibling,re=be.firstChild,ye=be.nextSibling,ve=ye.firstChild,Ye=ve.firstChild,we=Ye.nextSibling;we.nextSibling;var $e=ye.nextSibling,W=$e.nextSibling,Ze=S.nextSibling,U=Ze.firstChild,ze=U.firstChild,xe=ze.nextSibling,j=U.nextSibling;R.addEventListener("submit",Ke),T.style.setProperty("display","flex"),T.style.setProperty("flex-direction","row"),T.style.setProperty("margin-top","1rem"),T.style.setProperty("gap","1rem"),E.$$input=a=>s(a.currentTarget.value),E.style.setProperty("width","480px"),E.style.setProperty("height","512px"),S.style.setProperty("display","flex"),S.style.setProperty("flex-direction","column"),S.style.setProperty("gap","1rem"),F.$$input=a=>o(Number(a.currentTarget.value)),Z.$$input=a=>c(Number(a.currentTarget.value)),z.$$input=a=>d(Number(a.currentTarget.value)),ee.$$input=a=>b(Number(a.currentTarget.value)),v(te,Q,null),v(ge,()=>oe().toFixed(3),me),re.$$input=a=>K(Number(a.currentTarget.value)),v(ve,()=>(u()*h()/8/1e3).toFixed(),we),v(S,N(I,{get when(){return _()==="working"},get children(){return[(()=>{var a=gt(),C=a.firstChild;return x($=>($=`${qe()}%`)!=null?C.style.setProperty("width",$):C.style.removeProperty("width")),a})(),(()=>{var a=mt(),C=a.firstChild,$=C.nextSibling;return $.nextSibling,v(a,()=>le()+1,$),v(a,Q,null),a})(),(()=>{var a=bt();return a.firstChild,v(a,()=>(1e3/Je()).toFixed(1),null),a})()]}}),W),v(S,N(I,{get when(){return ce()!==0},get children(){var a=yt(),C=a.firstChild,$=C.nextSibling;return $.nextSibling,v(a,()=>(ce()/1e3).toFixed(),$),a}}),W),v(S,N(I,{get when(){return _()==="error"},get children(){return vt()}}),W),v(W,He),U.style.setProperty("margin-bottom","1rem"),U.style.setProperty("display","flex"),U.style.setProperty("gap","1rem"),xe.$$click=()=>r(!t()),v(xe,N(I,{get when(){return t()},fallback:"Enable",children:"Disable"}));var Se=e;return typeof Se=="function"?dt(Se,j):e=j,x(a=>{var C=_()!=="idle",$=_()!=="idle",_e=_()!=="idle",Ce=_()!=="idle",Pe=_()!=="idle",Te=_()!=="idle",Ee=_()!=="idle",Ae=i(),Le=l();return C!==a.e&&(E.disabled=a.e=C),$!==a.t&&(F.disabled=a.t=$),_e!==a.a&&(Z.disabled=a.a=_e),Ce!==a.o&&(z.disabled=a.o=Ce),Pe!==a.i&&(ee.disabled=a.i=Pe),Te!==a.n&&(re.disabled=a.n=Te),Ee!==a.s&&($e.disabled=a.s=Ee),Ae!==a.h&&ke(j,"width",a.h=Ae),Le!==a.r&&ke(j,"height",a.r=Le),a},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0}),x(()=>E.value=n()),x(()=>F.value=i()),x(()=>Z.value=l()),x(()=>z.value=u()),x(()=>ee.value=p()),x(()=>re.value=h()),R})()},xt=e=>{const t=window.URL.createObjectURL(new Blob([e])),r=document.createElement("a");r.style.display="none",r.href=t,r.download="render.webm",document.body.appendChild(r),r.click(),window.URL.revokeObjectURL(t)},St=`
void mainImage(out vec4 fragColor, in vec2 fragCoord) {
    // Normalized pixel coordinates (from 0 to 1)
    vec2 uv = fragCoord/iResolution.xy;

    // Time varying pixel color
    vec3 col = 0.5 + 0.5*cos(iTime+uv.xyx+vec3(0,2,4));

    // Output to screen
    fragColor = vec4(col,1.0);
}
`;ft(["input","click"]);var _t=P("<footer><p>Brought to you by veik</p><p><a class=cs-a href=https://github.com/Veikkosuhonen/renderoija>Github</a></p><p>Style  <a class=cs-a href=https://cs16.samke.me/>cs16.css</a></p><p>Muxing  <a class=cs-a href=https://github.com/Vanilagy/webm-muxer>Vanilagy/webm-muxer"),Oe=P("<hr class=cs-hr>"),Ct=P("<header><h1>Renderoija</h1><div><section><p>ShaderToy compatible GLSL to webm video renderer.<br>Supports only single pass shaders.</p></section><section><p>Your code must implement:<br>void mainImage(out vec4 fragColor, in vec2 fragCoord)</p></section><section><p>Uniforms:</p><ul><li>vec2 iResolution</li><li>float iTime</li><li>int iFrame</li><li>vec4 iMouse (0, 0, 0, 0)");const Pt=()=>[(()=>{var e=_t();return e.style.setProperty("display","flex"),e.style.setProperty("gap","3rem"),e})(),(()=>{var e=Oe();return e.style.setProperty("margin","0.5rem 0"),e})(),(()=>{var e=Ct(),t=e.firstChild,r=t.nextSibling,n=r.firstChild,s=n.nextSibling,i=s.nextSibling,o=i.firstChild,l=o.nextSibling;return e.style.setProperty("padding-top","2rem"),e.style.setProperty("padding-bottom","2rem"),r.style.setProperty("display","flex"),r.style.setProperty("flex-direction","row"),r.style.setProperty("gap","3rem"),l.style.setProperty("list-style-type","none"),l.style.setProperty("padding","0"),e})(),(()=>{var e=Oe();return e.style.setProperty("margin-bottom","1rem"),e})(),N($t,{})],Tt=document.getElementById("root");ut(()=>N(Pt,{}),Tt);
