(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const i of n)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function s(n){const i={};return n.integrity&&(i.integrity=n.integrity),n.referrerPolicy&&(i.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?i.credentials="include":n.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(n){if(n.ep)return;n.ep=!0;const i=s(n);fetch(n.href,i)}})();const Ze=!1,ze=(e,t)=>e===t,W={equals:ze};let et=je;const A=1,I=2,Be={owned:null,cleanups:null,context:null,owner:null};var g=null;let re=null,tt=null,f=null,h=null,P=null,q=0;function st(e,t){const s=f,r=g,n=e.length===0,i=t===void 0?r:t,o=n?Be:{owned:null,cleanups:null,context:i?i.context:null,owner:i},l=n?e:()=>e(()=>N(()=>k(o)));g=o,f=null;try{return U(l,!0)}finally{f=s,g=r}}function w(e,t){t=t?Object.assign({},W,t):W;const s={value:e,observers:null,observerSlots:null,comparator:t.equals||void 0},r=n=>(typeof n=="function"&&(n=n(s.value)),De(s,n));return[Me.bind(s),r]}function y(e,t,s){const r=We(e,t,!1,A);V(r)}function ie(e,t,s){s=s?Object.assign({},W,s):W;const r=We(e,t,!0,0);return r.observers=null,r.observerSlots=null,r.comparator=s.equals||void 0,V(r),Me.bind(r)}function N(e){if(f===null)return e();const t=f;f=null;try{return e()}finally{f=t}}function Me(){if(this.sources&&this.state)if(this.state===A)V(this);else{const e=h;h=null,U(()=>j(this),!1),h=e}if(f){const e=this.observers?this.observers.length:0;f.sources?(f.sources.push(this),f.sourceSlots.push(e)):(f.sources=[this],f.sourceSlots=[e]),this.observers?(this.observers.push(f),this.observerSlots.push(f.sources.length-1)):(this.observers=[f],this.observerSlots=[f.sources.length-1])}return this.value}function De(e,t,s){let r=e.value;return(!e.comparator||!e.comparator(r,t))&&(e.value=t,e.observers&&e.observers.length&&U(()=>{for(let n=0;n<e.observers.length;n+=1){const i=e.observers[n],o=re&&re.running;o&&re.disposed.has(i),(o?!i.tState:!i.state)&&(i.pure?h.push(i):P.push(i),i.observers&&Ge(i)),o||(i.state=A)}if(h.length>1e6)throw h=[],new Error},!1)),t}function V(e){if(!e.fn)return;k(e);const t=q;nt(e,e.value,t)}function nt(e,t,s){let r;const n=g,i=f;f=g=e;try{r=e.fn(t)}catch(o){return e.pure&&(e.state=A,e.owned&&e.owned.forEach(k),e.owned=null),e.updatedAt=s+1,qe(o)}finally{f=i,g=n}(!e.updatedAt||e.updatedAt<=s)&&(e.updatedAt!=null&&"observers"in e?De(e,r):e.value=r,e.updatedAt=s)}function We(e,t,s,r=A,n){const i={fn:e,state:r,updatedAt:null,owned:null,sources:null,sourceSlots:null,cleanups:null,value:t,owner:g,context:g?g.context:null,pure:s};return g===null||g!==Be&&(g.owned?g.owned.push(i):g.owned=[i]),i}function Ie(e){if(e.state===0)return;if(e.state===I)return j(e);if(e.suspense&&N(e.suspense.inFallback))return e.suspense.effects.push(e);const t=[e];for(;(e=e.owner)&&(!e.updatedAt||e.updatedAt<q);)e.state&&t.push(e);for(let s=t.length-1;s>=0;s--)if(e=t[s],e.state===A)V(e);else if(e.state===I){const r=h;h=null,U(()=>j(e,t[0]),!1),h=r}}function U(e,t){if(h)return e();let s=!1;t||(h=[]),P?s=!0:P=[],q++;try{const r=e();return rt(s),r}catch(r){s||(P=null),h=null,qe(r)}}function rt(e){if(h&&(je(h),h=null),e)return;const t=P;P=null,t.length&&U(()=>et(t),!1)}function je(e){for(let t=0;t<e.length;t++)Ie(e[t])}function j(e,t){e.state=0;for(let s=0;s<e.sources.length;s+=1){const r=e.sources[s];if(r.sources){const n=r.state;n===A?r!==t&&(!r.updatedAt||r.updatedAt<q)&&Ie(r):n===I&&j(r,t)}}}function Ge(e){for(let t=0;t<e.observers.length;t+=1){const s=e.observers[t];s.state||(s.state=I,s.pure?h.push(s):P.push(s),s.observers&&Ge(s))}}function k(e){let t;if(e.sources)for(;e.sources.length;){const s=e.sources.pop(),r=e.sourceSlots.pop(),n=s.observers;if(n&&n.length){const i=n.pop(),o=s.observerSlots.pop();r<n.length&&(i.sourceSlots[o]=r,n[r]=i,s.observerSlots[r]=o)}}if(e.tOwned){for(t=e.tOwned.length-1;t>=0;t--)k(e.tOwned[t]);delete e.tOwned}if(e.owned){for(t=e.owned.length-1;t>=0;t--)k(e.owned[t]);e.owned=null}if(e.cleanups){for(t=e.cleanups.length-1;t>=0;t--)e.cleanups[t]();e.cleanups=null}e.state=0}function it(e){return e instanceof Error?e:new Error(typeof e=="string"?e:"Unknown error",{cause:e})}function qe(e,t=g){throw it(e)}function R(e,t){return N(()=>e(t||{}))}const lt=e=>`Stale read from <${e}>.`;function le(e){const t=e.keyed,s=ie(()=>e.when,void 0,void 0),r=t?s:ie(s,void 0,{equals:(n,i)=>!n==!i});return ie(()=>{const n=r();if(n){const i=e.children;return typeof i=="function"&&i.length>0?N(()=>i(t?n:()=>{if(!N(r))throw lt("Show");return s()})):i}return e.fallback},void 0,void 0)}function ot(e,t,s){let r=s.length,n=t.length,i=r,o=0,l=0,a=t[n-1].nextSibling,u=null;for(;o<n||l<i;){if(t[o]===s[l]){o++,l++;continue}for(;t[n-1]===s[i-1];)n--,i--;if(n===o){const d=i<r?l?s[l-1].nextSibling:s[i-l]:a;for(;l<i;)e.insertBefore(s[l++],d)}else if(i===l)for(;o<n;)(!u||!u.has(t[o]))&&t[o].remove(),o++;else if(t[o]===s[i-1]&&s[l]===t[n-1]){const d=t[--n].nextSibling;e.insertBefore(s[l++],t[o++].nextSibling),e.insertBefore(s[--i],d),t[n]=s[i]}else{if(!u){u=new Map;let p=l;for(;p<i;)u.set(s[p],p++)}const d=u.get(t[o]);if(d!=null)if(l<d&&d<i){let p=o,b=1,m;for(;++p<n&&p<i&&!((m=u.get(t[p]))==null||m!==d+b);)b++;if(b>d-l){const ce=t[o];for(;l<d;)e.insertBefore(s[l++],ce)}else e.replaceChild(s[l++],t[o++])}else o++;else t[o++].remove()}}}const Re="_$DX_DELEGATE";function ct(e,t,s,r={}){let n;return st(i=>{n=i,t===document?e():S(t,e(),t.firstChild?null:void 0,s)},r.owner),()=>{n(),t.textContent=""}}function C(e,t,s,r){let n;const i=()=>{const l=document.createElement("template");return l.innerHTML=e,l.content.firstChild},o=()=>(n||(n=i())).cloneNode(!0);return o.cloneNode=o,o}function at(e,t=window.document){const s=t[Re]||(t[Re]=new Set);for(let r=0,n=e.length;r<n;r++){const i=e[r];s.has(i)||(s.add(i),t.addEventListener(i,ft))}}function ke(e,t,s){s==null?e.removeAttribute(t):e.setAttribute(t,s)}function ut(e,t,s){return N(()=>e(t,s))}function S(e,t,s,r){if(s!==void 0&&!r&&(r=[]),typeof t!="function")return G(e,t,r,s);y(n=>G(e,t(),n,s),r)}function ft(e){let t=e.target;const s=`$$${e.type}`,r=e.target,n=e.currentTarget,i=a=>Object.defineProperty(e,"target",{configurable:!0,value:a}),o=()=>{const a=t[s];if(a&&!t.disabled){const u=t[`${s}Data`];if(u!==void 0?a.call(t,u,e):a.call(t,e),e.cancelBubble)return}return t.host&&typeof t.host!="string"&&!t.host._$host&&t.contains(e.target)&&i(t.host),!0},l=()=>{for(;o()&&(t=t._$host||t.parentNode||t.host););};if(Object.defineProperty(e,"currentTarget",{configurable:!0,get(){return t||document}}),e.composedPath){const a=e.composedPath();i(a[0]);for(let u=0;u<a.length-2&&(t=a[u],!!o());u++){if(t._$host){t=t._$host,l();break}if(t.parentNode===n)break}}else l();i(r)}function G(e,t,s,r,n){for(;typeof s=="function";)s=s();if(t===s)return s;const i=typeof t,o=r!==void 0;if(e=o&&s[0]&&s[0].parentNode||e,i==="string"||i==="number"){if(i==="number"&&(t=t.toString(),t===s))return s;if(o){let l=s[0];l&&l.nodeType===3?l.data!==t&&(l.data=t):l=document.createTextNode(t),s=L(e,s,r,l)}else s!==""&&typeof s=="string"?s=e.firstChild.data=t:s=e.textContent=t}else if(t==null||i==="boolean")s=L(e,s,r);else{if(i==="function")return y(()=>{let l=t();for(;typeof l=="function";)l=l();s=G(e,l,s,r)}),()=>s;if(Array.isArray(t)){const l=[],a=s&&Array.isArray(s);if(oe(l,t,s,n))return y(()=>s=G(e,l,s,r,!0)),()=>s;if(l.length===0){if(s=L(e,s,r),o)return s}else a?s.length===0?Ue(e,l,r):ot(e,s,l):(s&&L(e),Ue(e,l));s=l}else if(t.nodeType){if(Array.isArray(s)){if(o)return s=L(e,s,r,t);L(e,s,null,t)}else s==null||s===""||!e.firstChild?e.appendChild(t):e.replaceChild(t,e.firstChild);s=t}}return s}function oe(e,t,s,r){let n=!1;for(let i=0,o=t.length;i<o;i++){let l=t[i],a=s&&s[e.length],u;if(!(l==null||l===!0||l===!1))if((u=typeof l)=="object"&&l.nodeType)e.push(l);else if(Array.isArray(l))n=oe(e,l,a)||n;else if(u==="function")if(r){for(;typeof l=="function";)l=l();n=oe(e,Array.isArray(l)?l:[l],Array.isArray(a)?a:[a])||n}else e.push(l),n=!0;else{const d=String(l);a&&a.nodeType===3&&a.data===d?e.push(a):e.push(document.createTextNode(d))}}return n}function Ue(e,t,s=null){for(let r=0,n=t.length;r<n;r++)e.insertBefore(t[r],s)}function L(e,t,s,r){if(s===void 0)return e.textContent="";const n=r||document.createTextNode("");if(t.length){let i=!1;for(let o=t.length-1;o>=0;o--){const l=t[o];if(n!==l){const a=l.parentNode===e;!i&&!o?a?e.replaceChild(n,l):e.insertBefore(n,s):a&&l.remove()}else i=!0}}else e.insertBefore(n,s);return[n]}const dt=async(e,t,s)=>{const r=new Worker(new URL(""+new URL("rendererWorker-93FchJSy.js",import.meta.url).href,import.meta.url)),n=new Worker(new URL(""+new URL("encoderWorker-CRxPo6p9.js",import.meta.url).href,import.meta.url),{type:"module"}),i={messageType:"submit",job:e};r.postMessage(i);const o=new Promise((d,p)=>{r.onmessage=b=>{const m=b.data;switch(m.messageType){case"frame":n.postMessage(m),t(m);break;case"completed":d(m),r.terminate();break;case"error":p(m.error),r.terminate();break}},r.onerror=b=>{p(b),r.terminate(),n.terminate()}});n.postMessage(i);const l=new Promise((d,p)=>{n.onmessage=b=>{const m=b.data;switch(m.messageType){case"frame":break;case"completed":d(m),n.terminate();break;case"error":p(m.error),n.terminate();break}},n.onerror=b=>{p(b),r.terminate(),n.terminate()}}),[a,u]=await Promise.all([o,l]);return u};var pt=C("<div class=cs-progress-bar><div class=bars>"),ht=C("<p>Rendering frame <!> of "),gt=C("<p>Render completed!"),mt=C("<p>Render failed!"),bt=C('<form><div><section><p>ShaderToy compatible GLSL renderer.<br>Supports only single pass shaders.</p></section><section><p>Your code must implement:<br>void mainImage(out vec4 fragColor, in vec2 fragCoord)</p></section><section><p>Uniforms:</p><ul><li>float iTime</li><li>vec2 iResolution</li><li>vec4 iMouse</li></ul></section></div><hr class=cs-hr><div><section><textarea class=cs-input placeholder="Paste GLSL"></textarea></section><section><div><input type=number class=cs-input id=width><label class=cs-input__label for=width>Width (px)</label></div><div><input type=number class=cs-input id=height><label class=cs-input__label for=height>Height (px)</label></div><div><input type=number class=cs-input id=duration><label class=cs-input__label for=duration>Duration (seconds)</label></div><div><input type=number class=cs-input id=fps><label class=cs-input__label for=fps>FPS</label></div><div><p>Frames: </p><p>Frame time: <!>s</p></div><div><input type=number class=cs-input id=bitrate><label class=cs-input__label for=bitrate>Bitrate</label></div><div><p>Estimated file size: <!> KB</p></div><button class=cs-btn>Begin render</button><p></p></section><section><canvas class=cs-canvas id=output>');const yt=()=>{let e;const[t,s]=w(wt),[r,n]=w(256),[i,o]=w(256),[l,a]=w(1),[u,d]=w(30),[p,b]=w(1e6),[m,ce]=w("vp09.00.10.08"),[ae,Ve]=w(0),H=()=>l()*u(),ue=()=>1/u(),He=()=>ae()/(l()*u())*100,[v,J]=w("idle"),[Je,fe]=w(""),Ke=async F=>{F.preventDefault(),fe("");const E=e.getContext("bitmaprenderer"),K=$=>{Ve($.frame),E.transferFromImageBitmap($.image)},Q=$=>{};J("working");try{const $=await dt({glsl:t(),width:r(),height:i(),numFrames:H(),frameTime:ue(),framerate:u(),bitrate:p(),codec:m()},K,Q);vt($.buffer),J("completed")}catch($){const B=$;console.error(B),fe(B.toString()),J("error")}};return(()=>{var F=bt(),E=F.firstChild,K=E.firstChild,Q=K.nextSibling,$=Q.nextSibling,B=$.firstChild,de=B.nextSibling,X=E.nextSibling,O=X.nextSibling,pe=O.firstChild,Y=pe.firstChild,x=pe.nextSibling,he=x.firstChild,Z=he.firstChild,ge=he.nextSibling,z=ge.firstChild,me=ge.nextSibling,ee=me.firstChild,be=me.nextSibling,te=be.firstChild,ye=be.nextSibling,se=ye.firstChild;se.firstChild;var ve=se.nextSibling,Qe=ve.firstChild,we=Qe.nextSibling;we.nextSibling;var Se=ye.nextSibling,ne=Se.firstChild,$e=Se.nextSibling,xe=$e.firstChild,Xe=xe.firstChild,_e=Xe.nextSibling;_e.nextSibling;var Ce=$e.nextSibling,M=Ce.nextSibling,Ye=x.nextSibling,D=Ye.firstChild;F.addEventListener("submit",Ke),E.style.setProperty("display","flex"),E.style.setProperty("flex-direction","row"),E.style.setProperty("gap","3rem"),de.style.setProperty("list-style-type","none"),de.style.setProperty("padding","0"),X.style.setProperty("margin-top","1rem"),X.style.setProperty("margin-bottom","1rem"),O.style.setProperty("display","flex"),O.style.setProperty("flex-direction","row"),O.style.setProperty("margin-top","1rem"),O.style.setProperty("gap","1rem"),Y.$$input=c=>s(c.currentTarget.value),x.style.setProperty("display","flex"),x.style.setProperty("flex-direction","column"),x.style.setProperty("gap","1rem"),Z.$$input=c=>n(Number(c.currentTarget.value)),z.$$input=c=>o(Number(c.currentTarget.value)),ee.$$input=c=>a(Number(c.currentTarget.value)),te.$$input=c=>d(Number(c.currentTarget.value)),S(se,H,null),S(ve,()=>ue().toFixed(3),we),ne.$$input=c=>b(Number(c.currentTarget.value)),S(xe,()=>(l()*p()/8/1e3).toFixed(),_e),S(x,R(le,{get when(){return v()==="working"},get children(){return[(()=>{var c=pt(),T=c.firstChild;return y(_=>(_=`${He()}%`)!=null?T.style.setProperty("width",_):T.style.removeProperty("width")),c})(),(()=>{var c=ht(),T=c.firstChild,_=T.nextSibling;return _.nextSibling,S(c,()=>ae()+1,_),S(c,H,null),c})()]}}),M),S(x,R(le,{get when(){return v()==="completed"},get children(){return gt()}}),M),S(x,R(le,{get when(){return v()==="error"},get children(){return mt()}}),M),S(M,Je);var Ee=e;return typeof Ee=="function"?ut(Ee,D):e=D,y(c=>{var T=v()!=="idle",_=v()!=="idle",Te=v()!=="idle",Pe=v()!=="idle",Ae=v()!=="idle",Le=v()!=="idle",Ne=v()!=="idle",Fe=r(),Oe=i();return T!==c.e&&(Y.disabled=c.e=T),_!==c.t&&(Z.disabled=c.t=_),Te!==c.a&&(z.disabled=c.a=Te),Pe!==c.o&&(ee.disabled=c.o=Pe),Ae!==c.i&&(te.disabled=c.i=Ae),Le!==c.n&&(ne.disabled=c.n=Le),Ne!==c.s&&(Ce.disabled=c.s=Ne),Fe!==c.h&&ke(D,"width",c.h=Fe),Oe!==c.r&&ke(D,"height",c.r=Oe),c},{e:void 0,t:void 0,a:void 0,o:void 0,i:void 0,n:void 0,s:void 0,h:void 0,r:void 0}),y(()=>Y.value=t()),y(()=>Z.value=r()),y(()=>z.value=i()),y(()=>ee.value=l()),y(()=>te.value=u()),y(()=>ne.value=p()),F})()},vt=e=>{const t=window.URL.createObjectURL(new Blob([e])),s=document.createElement("a");s.style.display="none",s.href=t,s.download="render.webm",document.body.appendChild(s),s.click(),window.URL.revokeObjectURL(t)},wt=`
void mainImage(out vec4 fragColor, in vec2 fragCoord) {
    // Normalized pixel coordinates (from 0 to 1)
    vec2 uv = fragCoord/iResolution.xy;

    // Time varying pixel color
    vec3 col = 0.5 + 0.5*cos(iTime+uv.xyx+vec3(0,2,4));

    // Output to screen
    fragColor = vec4(col,1.0);
}
`;at(["input"]);var St=C("<header><h1>Renderoija"),$t=C("<hr class=cs-hr>"),xt=C("<footer><p>Style originally by <a class=cs-a href=https://cs16.samke.me/>cs16.css");const _t=()=>[St(),R(yt,{}),(()=>{var e=$t();return e.style.setProperty("margin","2rem 0"),e})(),xt()],Ct=document.getElementById("root");ct(()=>R(_t,{}),Ct);
